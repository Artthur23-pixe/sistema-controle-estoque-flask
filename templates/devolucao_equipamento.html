{% extends "base.html" %}
{% block content %}
    <h1>Devolução de Equipamento</h1>
    <hr>
    <form method="post">
        <div class="row">
            <div class="col-md-6 mb-3">
                <label class="form-label">Responsável pela Devolução</label>
                <input type="text" class="form-control" value="{{ current_user.username }}" readonly>
            </div>
            <div class="col-md-6 mb-3">
                <label for="origem" class="form-label">De onde veio o equipamento? (Setor, Local, etc.)</label>
                <input type="text" class="form-control" id="origem" name="origem" required>
            </div>
        </div>
        <hr>
        <div id="items-container">
            <!-- Primeira linha de item -->
            <div class="row item-row mb-2 align-items-end">
                <div class="col-md-7">
                    <label class="form-label">Equipamento</label>
                    <select class="form-select" name="produto_id[]" required>
                        <option value="" disabled selected>Selecione um equipamento...</option>
                        {% for produto in produtos %}<option value="{{ produto.id }}">{{ produto.nome }}</option>{% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Quantidade</label>
                    <input type="number" class="form-control" name="quantidade[]" min="1" required>
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-danger w-100" onclick="removeItem(this)">Remover</button>
                </div>
            </div>
        </div>
        <button type="button" class="btn btn-outline-success mt-2" onclick="addItem()">Adicionar Outro Equipamento</button>
        <hr>
        <button type="submit" class="btn btn-primary">Confirmar Devolução</button>
        <a href="{{ url_for('index') }}" class="btn btn-secondary">Cancelar</a>
    </form>
    <!-- Template para novas linhas de item -->
    <template id="item-template">
        <div class="row item-row mb-2 align-items-end">
            <div class="col-md-7">
                <label class="form-label">Equipamento</label>
                <select class="form-select" name="produto_id[]" required>
                    <option value="" disabled selected>Selecione um equipamento...</option>
                    {% for produto in produtos %}<option value="{{ produto.id }}">{{ produto.nome }}</option>{% endfor %}
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label">Quantidade</label>
                <input type="number" class="form-control" name="quantidade[]" min="1" required>
            </div>
            <div class="col-md-2">
                <button type="button" class="btn btn-danger w-100" onclick="removeItem(this)">Remover</button>
            </div>
        </div>
    </template>
{% endblock %}