{% extends "base.html" %}
{% block content %}
    <h1>Informar Distribuição de Equipamento</h1>
    <hr>
    {% if not retiradas_pendentes %}
        <div class="alert alert-info">Não há retiradas com distribuição pendente.</div>
    {% else %}
    <form method="post" id="distribution-form">
        <div class="mb-3">
            <label for="retirada_id" class="form-label">Selecione a Retirada Pendente</label>
            <select class="form-select" id="retirada_id" name="retirada_id" required>
                <option value="" disabled selected>Escolha uma retirada...</option>
                {% for retirada in retiradas_pendentes %}
                <option value="{{ retirada.id }}">
                    #{{ retirada.id }} - Por {{ retirada.responsavel }} para {{ retirada.destino_geral }} ({{ retirada.data_hora.strftime('%d/%m') }})
                </option>
                {% endfor %}
            </select>
        </div>
        <div id="details-section" class="d-none">
            <div class="card bg-dark border-secondary">
                <div class="card-header">Itens Totais da Retirada</div>
                <ul class="list-group list-group-flush" id="retirada-items-list"></ul>
            </div>
            <hr>
            <h4 class="mb-3">Informe os Destinos Finais</h4>
            <div id="destinos-container"></div>
            <button type="button" class="btn btn-sm btn-outline-success mt-2" onclick="addDestinoRow()">Adicionar Unidade de Saúde</button>
            <hr>
            <h4 class="mb-3">Informe as Sobras (Devolução ao Estoque)</h4>
            <div id="devolucao-container"></div>
            <button type="button" class="btn btn-sm btn-outline-info mt-2" onclick="addDevolucaoRow()">Adicionar Sobra</button>
            <hr>
            <button type="submit" class="btn btn-primary btn-lg">Confirmar Distribuição</button>
        </div>
    </form>
    {% endif %}

{% endblock %}